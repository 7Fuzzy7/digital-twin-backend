<!doctype html>
<html lang="pt-BR">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Debug WS/HTTP</title>
<style>body{font-family:system-ui;margin:18px}pre{background:#f7f7f7;padding:10px;border-radius:8px;max-height:240px;overflow:auto}</style>
</head>
<body>
  <h1>Debug â€” WS/HTTP</h1>
  <p>WS: <input id="wsUrl" value="ws://localhost:3000/ws" style="min-width:380px"> <button id="btnConnect">Conectar</button> <span id="status">desconectado</span></p>
  <p><button id="btnLast">GET /data/last</button> <button id="btnEvents">GET /data/events?limit=20</button></p>
  <pre id="box"></pre>
  <script>
    const $=id=>document.getElementById(id); let ws=null;
    $("btnConnect").onclick=()=>{ const url=$("wsUrl").value; ws=new WebSocket(url); ws.onopen=()=>$("status").textContent="conectado"; ws.onclose=()=>$("status").textContent="desconectado"; ws.onmessage=(e)=>{ $("box").textContent += ( $("box").textContent?'\n':'') + e.data; }; };
    $("btnLast").onclick=async()=>{ const r=await fetch('/data/last'); $("box").textContent=JSON.stringify(await r.json(),null,2); };
    $("btnEvents").onclick=async()=>{ const r=await fetch('/data/events?limit=20'); $("box").textContent=JSON.stringify(await r.json(),null,2); };
  </script>
</body>
</html>
